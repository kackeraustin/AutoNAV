<Window x:Class="AutoNAVSearchSets.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AutoNav SearchSets - Automatic Search Set Creation"
        Height="900" Width="950"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Background="#F5F5F5"
        Loaded="Window_Loaded">

    <Window.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>

        <Style x:Key="SubHeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#34495E"/>
            <Setter Property="Margin" Value="0,5,0,5"/>
        </Style>

        <Style x:Key="DescriptionTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#7F8C8D"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>

        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#3498DB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2980B9"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#BDC3C7"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#95A5A6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#7F8C8D"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#BDC3C7"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#BDC3C7"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="Padding" Value="15"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="AutoNav SearchSets"
                       FontSize="24"
                       FontWeight="Bold"
                       Foreground="#2C3E50"
                       Margin="0,0,0,5"/>
            <TextBlock Text="Automated Search Set Creation for Navisworks"
                       FontSize="12"
                       Foreground="#95A5A6"/>
        </StackPanel>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <!-- Function 1: Discipline Search Sets -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock Text="FUNCTION 1: Discipline Search Sets"
                                   Style="{StaticResource HeaderTextStyle}"
                                   Margin="0"/>
                    </GroupBox.Header>

                    <StackPanel>
                        <TextBlock Style="{StaticResource DescriptionTextStyle}">
                            <Run FontWeight="SemiBold">Purpose:</Run>
                            <Run>Creates search sets organized by discipline based on file naming patterns.</Run>
                        </TextBlock>

                        <Button x:Name="btnCreateDisciplineSets"
                                Content="Create Discipline Search Sets"
                                Style="{StaticResource ActionButtonStyle}"
                                Click="BtnCreateDisciplineSets_Click"
                                HorizontalAlignment="Left"/>
                    </StackPanel>
                </GroupBox>

                <!-- Function 2: Element Category Search Sets -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock Text="FUNCTION 2: Element Category Search Sets"
                                   Style="{StaticResource HeaderTextStyle}"
                                   Margin="0"/>
                    </GroupBox.Header>

                    <StackPanel>
                        <TextBlock Style="{StaticResource DescriptionTextStyle}">
                            <Run FontWeight="SemiBold">Purpose:</Run>
                            <Run>Creates search sets for each element category found within selected discipline models. Each search set is scoped to its source file using locator filtering. Discipline folders are created at the root level for manual organization into '2. CLASH SETS' folder.</Run>
                        </TextBlock>

                        <!-- Model Selection Checkboxes -->
                        <TextBlock Style="{StaticResource SubHeaderTextStyle}">
                            Select Discipline Models:
                        </TextBlock>

                        <StackPanel Orientation="Horizontal" Margin="0,5,0,5">
                            <Button x:Name="btnCheckAllFunc2"
                                    Content="Check All"
                                    Click="BtnCheckAllFunc2_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="10,5"
                                    Margin="0,0,5,0"/>
                            <Button x:Name="btnUncheckAllFunc2"
                                    Content="Uncheck All"
                                    Click="BtnUncheckAllFunc2_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="10,5"
                                    Margin="0,0,5,0"/>
                            <Button x:Name="btnInvertSelectionFunc2"
                                    Content="Invert Selection"
                                    Click="BtnInvertSelectionFunc2_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="10,5"/>
                        </StackPanel>

                        <Border Background="#ECF0F1"
                                Padding="10"
                                CornerRadius="4"
                                Margin="0,5,0,15">
                            <StackPanel x:Name="pnlModelCheckboxes">
                                <!-- Checkboxes populated dynamically -->
                                <TextBlock Text="Run Function 1 first to populate discipline models"
                                          FontSize="11"
                                          Foreground="#7F8C8D"
                                          FontStyle="Italic"/>
                            </StackPanel>
                        </Border>

                        <TextBlock Style="{StaticResource SubHeaderTextStyle}">
                            Select Parameter to Organize By:
                        </TextBlock>

                        <StackPanel Margin="10,5,0,15">
                            <RadioButton x:Name="rbCategory"
                                       Content="Element Category"
                                       IsChecked="True"
                                       FontSize="12"
                                       Margin="0,5,0,5"
                                       GroupName="ElementParameter"/>
                            <TextBlock Text="Groups by Revit category (Walls, Doors, Floors, etc.)"
                                     FontSize="10"
                                     Foreground="#7F8C8D"
                                     Margin="20,0,0,10"/>

                            <RadioButton x:Name="rbSystemName"
                                       Content="System Name"
                                       FontSize="12"
                                       Margin="0,5,0,5"
                                       GroupName="ElementParameter"/>

                            <RadioButton x:Name="rbSystemClassification"
                                       Content="System Classification"
                                       FontSize="12"
                                       Margin="0,5,0,5"
                                       GroupName="ElementParameter"/>

                            <RadioButton x:Name="rbWorkset"
                                       Content="Workset"
                                       FontSize="12"
                                       Margin="0,5,0,5"
                                       GroupName="ElementParameter"/>

                            <RadioButton x:Name="rbFamilyType"
                                       Content="Family Type"
                                       FontSize="12"
                                       Margin="0,5,0,5"
                                       GroupName="ElementParameter"/>
                        </StackPanel>

                        <Button x:Name="btnCreateElementSets"
                                Content="Create Element Search Sets"
                                Style="{StaticResource ActionButtonStyle}"
                                Click="BtnCreateElementSets_Click"
                                HorizontalAlignment="Left"/>
                    </StackPanel>
                </GroupBox>

                <!-- Function 3: Custom Search Set Builder -->
                <GroupBox Style="{StaticResource GroupBoxStyle}">
                    <GroupBox.Header>
                        <TextBlock Text="FUNCTION 3: Custom Search Set Builder (Auto-Discovery)"
                                   Style="{StaticResource HeaderTextStyle}"
                                   Margin="0"/>
                    </GroupBox.Header>

                    <StackPanel>
                        <TextBlock Style="{StaticResource DescriptionTextStyle}">
                            <Run FontWeight="SemiBold">Purpose:</Run>
                            <Run>Automatically creates search sets for ALL unique values of a selected property within chosen discipline models. Each search set is scoped to its source file. Discipline folders are created at the root level for manual organization into '2. CLASH SETS' folder. A preview window will show what will be created before proceeding.</Run>
                        </TextBlock>

                        <!-- Model Selection Checkboxes for Function 3 -->
                        <TextBlock Style="{StaticResource SubHeaderTextStyle}">
                            Select Discipline Models:
                        </TextBlock>

                        <StackPanel Orientation="Horizontal" Margin="0,5,0,5">
                            <Button x:Name="btnCheckAllFunc3"
                                    Content="Check All"
                                    Click="BtnCheckAllFunc3_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="10,5"
                                    Margin="0,0,5,0"/>
                            <Button x:Name="btnUncheckAllFunc3"
                                    Content="Uncheck All"
                                    Click="BtnUncheckAllFunc3_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="10,5"
                                    Margin="0,0,5,0"/>
                            <Button x:Name="btnInvertSelectionFunc3"
                                    Content="Invert Selection"
                                    Click="BtnInvertSelectionFunc3_Click"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Padding="10,5"/>
                        </StackPanel>

                        <Border Background="#ECF0F1"
                                Padding="10"
                                CornerRadius="4"
                                Margin="0,5,0,15">
                            <StackPanel x:Name="pnlModelCheckboxesFunction3">
                                <!-- Checkboxes populated dynamically (same as Function 2) -->
                                <TextBlock Text="Run Function 1 first to populate discipline models"
                                          FontSize="11"
                                          Foreground="#7F8C8D"
                                          FontStyle="Italic"/>
                            </StackPanel>
                        </Border>

                        <!-- Analyze Properties Button -->
                        <Button x:Name="btnRescanProperties"
                              Content="ðŸ”„ Analyze Properties in Selected Models"
                              Style="{StaticResource SecondaryButtonStyle}"
                              Click="BtnRescanProperties_Click"
                              HorizontalAlignment="Left"
                              Margin="0,0,0,15"/>

                        <!-- Property Selection -->
                        <TextBlock Style="{StaticResource SubHeaderTextStyle}">
                            Property Selection:
                        </TextBlock>

                        <Grid Margin="0,5,0,15">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Property Category Row -->
                            <TextBlock Grid.Row="0" Grid.Column="0"
                                     Text="Property Category:"
                                     VerticalAlignment="Center"
                                     FontSize="12"
                                     Margin="0,0,10,10"/>
                            <ComboBox x:Name="cmbPropertyCategory"
                                    Grid.Row="0" Grid.Column="1"
                                    Height="30"
                                    FontSize="11"
                                    Margin="0,0,0,10"
                                    SelectionChanged="CmbPropertyCategory_SelectionChanged"/>
                                    <!-- Removed ItemTemplate to avoid any binding/escaping issues with special characters -->

                            <!-- Property Name Row -->
                            <TextBlock Grid.Row="1" Grid.Column="0"
                                     Text="Property Name:"
                                     VerticalAlignment="Center"
                                     FontSize="12"
                                     Margin="0,0,10,0"/>
                            <ComboBox x:Name="cmbPropertyName"
                                    Grid.Row="1" Grid.Column="1"
                                    Height="30"
                                    FontSize="11"/>
                                    <!-- Removed ItemTemplate to avoid any binding/escaping issues with special characters -->
                        </Grid>

                        <Border Background="#D1ECF1"
                                BorderBrush="#17A2B8"
                                BorderThickness="1"
                                Padding="10"
                                CornerRadius="4"
                                Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock FontSize="11" Foreground="#0C5460" TextWrapping="Wrap">
                                    <Run FontWeight="SemiBold">How It Works:</Run>
                                </TextBlock>
                                <TextBlock FontSize="10" Foreground="#0C5460" TextWrapping="Wrap" Margin="0,5,0,0">
                                    1. Select discipline models above
                                </TextBlock>
                                <TextBlock FontSize="10" Foreground="#0C5460" TextWrapping="Wrap">
                                    2. Click "Analyze Properties" to scan selected models
                                </TextBlock>
                                <TextBlock FontSize="10" Foreground="#0C5460" TextWrapping="Wrap">
                                    3. Choose Property Category and Property Name
                                </TextBlock>
                                <TextBlock FontSize="10" Foreground="#0C5460" TextWrapping="Wrap">
                                    4. Click "Create" - tool will show a preview of all search sets to be created
                                </TextBlock>
                                <TextBlock FontSize="10" Foreground="#0C5460" TextWrapping="Wrap">
                                    5. Confirm the preview to create individual search sets for each value (folders created at root level)
                                </TextBlock>
                            </StackPanel>
                        </Border>

                        <Button x:Name="btnCreateCustomSearchSets"
                                Content="Create Custom Search Sets (Auto-Discover Values)"
                                Style="{StaticResource ActionButtonStyle}"
                                Click="BtnCreateCustomSearchSets_Click"
                                HorizontalAlignment="Left"/>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2"
                Background="White"
                BorderBrush="#BDC3C7"
                BorderThickness="0,1,0,0"
                Padding="0,15,0,0"
                Margin="0,15,0,0">
            <StackPanel>
                <TextBlock x:Name="txtStatus"
                          Text="Ready"
                          FontSize="11"
                          Foreground="#27AE60"
                          FontWeight="SemiBold"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,10"/>

                <Button Content="Close"
                        Width="100"
                        Height="35"
                        Background="#95A5A6"
                        Foreground="White"
                        FontSize="12"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="BtnClose_Click"
                        HorizontalAlignment="Center">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}"
                                    CornerRadius="4">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#7F8C8D"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </StackPanel>
        </Border>
    </Grid>
</Window>
